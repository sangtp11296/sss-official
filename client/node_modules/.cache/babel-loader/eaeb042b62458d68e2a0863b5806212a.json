{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/sangt/OneDrive/Sang Shares Something/sss-official/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/sangt/OneDrive/Sang Shares Something/sss-official/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/sangt/OneDrive/Sang Shares Something/sss-official/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState}from'react';// import ReactQuill from 'react-quill';\nimport'react-quill/dist/quill.snow.css';import{Context}from'../../context/Context';import'./quill.css';import styles from'./Write.module.css';import axios from'axios';// import QuillEditor from '../../components/Editor/QuillEditor';\nimport{CKEditor}from'@ckeditor/ckeditor5-react';import Editor from'ckeditor5-custom-build/build/ckeditor';import'ckeditor5-custom-build/build/translations/vi';import'ckeditor5-custom-build/build/translations/de';import'ckeditor5-custom-build/build/translations/zh-cn';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(props){props.setWhiteHeaderCallback(true);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),section=_useState4[0],setSection=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),categories=_useState6[0],setCats=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),desc=_useState8[0],setDesc=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),photographer=_useState10[0],setPhotographer=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),cover=_useState12[0],setCover=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),content=_useState14[0],setContent=_useState14[1];var _useContext=useContext(Context),user=_useContext.user;var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),error=_useState16[0],setError=_useState16[1];function toSlug(str){// Chuyển hết sang chữ thường\nstr=str.toLowerCase();// xóa dấu\nstr=str.replace(/(à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ|ä)/g,'a');str=str.replace(/(è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ)/g,'e');str=str.replace(/(ì|í|ị|ỉ|ĩ)/g,'i');str=str.replace(/(ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ|ö)/g,'o');str=str.replace(/(ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ|ü)/g,'u');str=str.replace(/(ỳ|ý|ỵ|ỷ|ỹ)/g,'y');str=str.replace(/(đ)/g,'d');str=str.replace(/(ß)/g,'B');// Xóa ký tự đặc biệt\nstr=str.replace(/([^0-9a-z-\\s])/g,'');// Xóa khoảng trắng thay bằng ký tự -\nstr=str.replace(/(\\s+)/g,'-');// xóa phần dự - ở đầu\nstr=str.replace(/^-+/g,'');// xóa phần dư - ở cuối\nstr=str.replace(/-+$/g,'');// return\nreturn str;}var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setError(false);newPost={username:user.username,title:title,slug:toSlug(title),desc:desc,section:section,categories:categories,authorname:user.authorname,photographer:photographer,content:content,covername:Date.now()+'_'+toSlug(title)};if(!cover){_context.next=28;break;}_context.prev=4;_context.next=7;return axios.post('/posts',newPost);case 7:res=_context.sent;_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](4);setError(true);case 13:data=new FormData();data.append('type','postCover');data.append('file',cover);data.append('postID',res.data._id);_context.prev=17;_context.next=20;return axios.post('/upload',data);case 20:window.location.replace('/posts/'+res.data.slug);_context.next=26;break;case 23:_context.prev=23;_context.t1=_context[\"catch\"](17);setError(true);case 26:_context.next=29;break;case 28:window.alert(\"Please update your post cover!!!\");case 29:case\"end\":return _context.stop();}}},_callee,null,[[4,10],[17,23]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var editorConfiguration={removePlugins:['Title','Markdown','Watchdog'],language:{textPartLanguage:[{title:'English',languageCode:'en'},{title:'German',languageCode:'de'},{title:'Vietnamese',languageCode:'vi'},{title:'Chinese',languageCode:'zh-cn'}]},toolbar:{items:['textPartLanguage','heading','|','fontfamily','fontsize','|','alignment','|','fontColor','fontBackgroundColor','|','bold','italic','strikethrough','underline','subscript','superscript','|','link','|','outdent','indent','|','bulletedList','numberedList','todoList','horizontalLine','|','code','codeBlock','sourceEditing','|','insertTable','|','insertImage','mediaEmbed','blockQuote','|','undo','redo','findAndReplace','highlight','specialCharacters'],viewportTopOffset:30,shouldNotGroupWhenFull:true},ckfinder:{uploadUrl:'/uploads'},highlight:{options:[{model:'blueMarker',class:'marker-blue',title:'Blue marker',color:'var(--main-brand-color-theme)',type:'marker'},{model:'greenMarker',class:'marker-green',title:'Green marker',color:'var(--ck-highlight-marker-green)',type:'marker'},{model:'redPen',class:'pen-red',title:'Red pen',color:'var(--ck-highlight-pen-red)',type:'pen'}]},table:{contentToolbar:['tableColumn','tableRow','mergeTableCells','tableProperties','tableCellProperties','toggleTableCaption']},image:{toolbar:['imageStyle:inline','imageStyle:block','imageStyle:side','|','toggleImageCaption','imageTextAlternative','linkImage']},mediaEmbed:{removeProviders:['instagram','twitter','googleMaps','flickr','facebook']}};return/*#__PURE__*/_jsx(\"div\",{className:styles.container,children:/*#__PURE__*/_jsx(\"div\",{className:styles.write,children:/*#__PURE__*/_jsx(\"div\",{className:styles.writeContainer,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.writeForm,style:{display:\"flex\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.imageSide,children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Cover Image\"}),cover?/*#__PURE__*/_jsxs(\"div\",{className:styles.uploadImage,children:[/*#__PURE__*/_jsx(\"img\",{className:styles.coverPhoto,alt:\"\",src:URL.createObjectURL(cover)}),/*#__PURE__*/_jsx(\"i\",{className:\"\".concat(styles.xIcon,\" fas fa-times fa-2x\"),onClick:function onClick(e){setCover(null);}})]}):/*#__PURE__*/_jsxs(\"div\",{className:styles.uploadImage,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",className:styles.icon,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera-retro\"})}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",className:styles.uploadBtn,children:\"Upload Image\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",required:true,style:{display:'none'},onChange:function onChange(e){setCover(e.target.files[0]);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.notice,children:[\"For better design, please use:\",/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Minimum width image size is 1080\"}),/*#__PURE__*/_jsx(\"li\",{children:\"The best ratio is 16:9\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.textSide,children:/*#__PURE__*/_jsxs(\"form\",{className:styles.textForm,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.textField,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Title of the Post\",/*#__PURE__*/_jsx(\"span\",{className:styles.textDanger,children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{name:\"title\",type:\"text\",required:true,maxLength:\"500\",className:styles.textInput,autoFocus:true,placeholder:\"Title\",onChange:function onChange(e){setTitle(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.textField,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Photographer's Name\"}),/*#__PURE__*/_jsx(\"input\",{name:\"photographer\",type:\"text\",maxLength:\"500\",className:styles.textInput,placeholder:\"Photographer Name...\",onChange:function onChange(e){setPhotographer(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.textField,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Sections\",/*#__PURE__*/_jsx(\"span\",{className:styles.textDanger,children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{name:\"sections\",placeholder:\"Select section...\",className:styles.textInput,onChange:function onChange(e){setSection(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"none\",defaultValue:true,className:styles.items,children:\"Select section...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"photography\",className:styles.items,children:\"photography\"}),/*#__PURE__*/_jsx(\"option\",{value:\"explore\",className:styles.items,children:\"explore\"}),/*#__PURE__*/_jsx(\"option\",{value:\"photographers\",className:styles.items,children:\"photographers\"}),/*#__PURE__*/_jsx(\"option\",{value:\"challenge\",className:styles.items,children:\"challenge\"}),/*#__PURE__*/_jsx(\"option\",{value:\"book\",className:styles.items,children:\"book\"}),/*#__PURE__*/_jsx(\"option\",{value:\"music\",className:styles.items,children:\"music\"}),/*#__PURE__*/_jsx(\"option\",{value:\"life\",className:styles.items,children:\"life\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.textField,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Categories\",/*#__PURE__*/_jsx(\"span\",{className:styles.textDanger,children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{name:\"categories\",type:\"text\",className:styles.textInput,onChange:function onChange(e){setCats(e.target.value.split(' '));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.textField,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Description\",/*#__PURE__*/_jsx(\"span\",{className:styles.textDanger,children:\"*\"})]}),/*#__PURE__*/_jsx(\"textarea\",{name:\"description\",type:\"text\",className:styles.textInput,placeholder:\"Description\",onChange:function onChange(e){setDesc(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.textField,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Main Content\",/*#__PURE__*/_jsx(\"span\",{className:styles.textDanger,children:\"*\"})]}),/*#__PURE__*/_jsx(CKEditor,{editor:Editor,config:editorConfiguration// data='null'\n// onReady={ editor => {\n//     // You can store the \"editor\" and use when it is needed.\n//     console.log( 'Editor is ready to use!', editor );\n// } }\n,onChange:function onChange(event,editor){var data=editor.getData();// console.log( { event, editor, data } );\nsetContent(data);console.log(content);}// onBlur={ ( event, editor ) => {\n//     console.log( 'Blur.', editor );\n// } }\n// onFocus={ ( event, editor ) => {\n//     console.log( 'Focus.', editor );\n// } }\n})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.submit,children:[/*#__PURE__*/_jsx(\"button\",{className:styles.uploadBtn,children:\"Preview\"}),/*#__PURE__*/_jsx(\"button\",{className:styles.uploadBtn,type:\"submit\",children:\"Submit\"})]}),error?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h5\",{style:{color:'red',textAlign:'right'},children:\"Something went wrong! Please check again...\"})}):null]})})]})})})});}","map":{"version":3,"sources":["C:/Users/sangt/OneDrive/Sang Shares Something/sss-official/client/src/Pages/Write/Write.js"],"names":["React","useContext","useState","Context","styles","axios","CKEditor","Editor","Write","props","setWhiteHeaderCallback","title","setTitle","section","setSection","categories","setCats","desc","setDesc","photographer","setPhotographer","cover","setCover","content","setContent","user","error","setError","toSlug","str","toLowerCase","replace","handleSubmit","e","preventDefault","newPost","username","slug","authorname","covername","Date","now","post","res","data","FormData","append","_id","window","location","alert","editorConfiguration","removePlugins","language","textPartLanguage","languageCode","toolbar","items","viewportTopOffset","shouldNotGroupWhenFull","ckfinder","uploadUrl","highlight","options","model","class","color","type","table","contentToolbar","image","mediaEmbed","removeProviders","container","write","writeContainer","writeForm","display","imageSide","uploadImage","coverPhoto","URL","createObjectURL","xIcon","icon","uploadBtn","target","files","notice","textSide","textForm","textField","textDanger","textInput","value","split","event","editor","getData","console","log","submit","textAlign"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react'\r\n// import ReactQuill from 'react-quill';\r\nimport 'react-quill/dist/quill.snow.css';\r\nimport { Context } from '../../context/Context';\r\nimport './quill.css'\r\nimport styles from './Write.module.css'\r\nimport axios from 'axios'\r\n// import QuillEditor from '../../components/Editor/QuillEditor';\r\nimport { CKEditor } from '@ckeditor/ckeditor5-react';\r\nimport Editor from 'ckeditor5-custom-build/build/ckeditor';\r\nimport 'ckeditor5-custom-build/build/translations/vi';\r\nimport 'ckeditor5-custom-build/build/translations/de';\r\nimport 'ckeditor5-custom-build/build/translations/zh-cn';\r\n\r\n\r\nexport default function Write(props) {\r\n    props.setWhiteHeaderCallback(true);  \r\n    const [title,setTitle] = useState('');\r\n    const [section,setSection] = useState('');\r\n    const [categories,setCats] = useState([]);\r\n    const [desc,setDesc] = useState('');\r\n    const [photographer,setPhotographer] = useState('');\r\n    const [cover,setCover] = useState(null);\r\n    const [content,setContent] = useState('');\r\n    const {user} = useContext(Context);\r\n    const [error,setError] = useState(false);\r\n\r\n    function toSlug(str)\r\n    {\r\n        // Chuyển hết sang chữ thường\r\n        str = str.toLowerCase();     \r\n    \r\n        // xóa dấu\r\n        str = str.replace(/(à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ|ä)/g, 'a');\r\n        str = str.replace(/(è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ)/g, 'e');\r\n        str = str.replace(/(ì|í|ị|ỉ|ĩ)/g, 'i');\r\n        str = str.replace(/(ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ|ö)/g, 'o');\r\n        str = str.replace(/(ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ|ü)/g, 'u');\r\n        str = str.replace(/(ỳ|ý|ỵ|ỷ|ỹ)/g, 'y');\r\n        str = str.replace(/(đ)/g, 'd');\r\n        str = str.replace(/(ß)/g, 'B');\r\n    \r\n        // Xóa ký tự đặc biệt\r\n        str = str.replace(/([^0-9a-z-\\s])/g, '');\r\n    \r\n        // Xóa khoảng trắng thay bằng ký tự -\r\n        str = str.replace(/(\\s+)/g, '-');\r\n    \r\n        // xóa phần dự - ở đầu\r\n        str = str.replace(/^-+/g, '');\r\n    \r\n        // xóa phần dư - ở cuối\r\n        str = str.replace(/-+$/g, '');\r\n    \r\n        // return\r\n        return str;\r\n    }\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setError(false)\r\n        const newPost = {\r\n            username:user.username,\r\n            title,\r\n            slug: toSlug(title),\r\n            desc,\r\n            section,\r\n            categories,\r\n            authorname:user.authorname,\r\n            photographer,\r\n            content,\r\n            covername: Date.now()+ '_' + toSlug(title)\r\n        }\r\n        if (cover){\r\n            try{\r\n                var res = await axios.post('/posts', newPost);\r\n            }catch(err){\r\n                setError(true)\r\n            }\r\n            const data = new FormData();\r\n            data.append('type','postCover')\r\n            data.append('file',cover);\r\n            data.append('postID',res.data._id);\r\n            try{\r\n                await axios.post('/upload', data)\r\n                window.location.replace('/posts/' + res.data.slug);\r\n            } catch (err){\r\n                setError(true)\r\n            }\r\n        } else {window.alert(\"Please update your post cover!!!\");}\r\n    }\r\n\r\n    const editorConfiguration = {\r\n        removePlugins: ['Title','Markdown', 'Watchdog'],\r\n        language:{\r\n            textPartLanguage: [\r\n                { title: 'English', languageCode: 'en' },\r\n                { title: 'German', languageCode: 'de' },\r\n                { title: 'Vietnamese', languageCode: 'vi' },\r\n                { title: 'Chinese', languageCode: 'zh-cn'}\r\n            ]\r\n        },\r\n        toolbar: {\r\n            items: [\r\n                'textPartLanguage', 'heading', '|',\r\n                'fontfamily', 'fontsize', '|',\r\n                'alignment', '|',\r\n                'fontColor', 'fontBackgroundColor', '|',\r\n                'bold', 'italic', 'strikethrough', 'underline', 'subscript', 'superscript', '|',\r\n                'link', '|',\r\n                'outdent', 'indent', '|',\r\n                'bulletedList', 'numberedList', 'todoList', 'horizontalLine', '|',\r\n                'code', 'codeBlock', 'sourceEditing', '|',\r\n                'insertTable', '|',\r\n                'insertImage', 'mediaEmbed', 'blockQuote', '|',\r\n                'undo', 'redo', 'findAndReplace', 'highlight', 'specialCharacters'\r\n            ],\r\n            viewportTopOffset: 30,\r\n            shouldNotGroupWhenFull: true\r\n        },\r\n        ckfinder: {\r\n            uploadUrl: '/uploads'\r\n        },\r\n        highlight: {\r\n            options: [\r\n                {\r\n                    model: 'blueMarker',\r\n                    class: 'marker-blue',\r\n                    title: 'Blue marker',\r\n                    color: 'var(--main-brand-color-theme)',\r\n                    type: 'marker'\r\n                },\r\n                {\r\n                    model: 'greenMarker',\r\n                    class: 'marker-green',\r\n                    title: 'Green marker',\r\n                    color: 'var(--ck-highlight-marker-green)',\r\n                    type: 'marker'\r\n                },\r\n                {\r\n                    model: 'redPen',\r\n                    class: 'pen-red',\r\n                    title: 'Red pen',\r\n                    color: 'var(--ck-highlight-pen-red)',\r\n                    type: 'pen'\r\n                }\r\n            ]\r\n        },\r\n        table: {\r\n            contentToolbar: [\r\n                'tableColumn', 'tableRow', 'mergeTableCells',\r\n                'tableProperties', 'tableCellProperties', 'toggleTableCaption'\r\n            ],\r\n        },\r\n        image: {\r\n            toolbar: [\r\n                'imageStyle:inline',\r\n                'imageStyle:block',\r\n                'imageStyle:side',\r\n                '|',\r\n                'toggleImageCaption',\r\n                'imageTextAlternative',\r\n                'linkImage'\r\n            ]},\r\n        mediaEmbed: {\r\n            removeProviders: [ 'instagram', 'twitter', 'googleMaps', 'flickr', 'facebook' ]\r\n        }\r\n    };\r\n    return (\r\n        <div className={styles.container}>\r\n            <div className={styles.write}>\r\n                <div className={styles.writeContainer}>\r\n                    <div className={styles.writeForm} style={{display:\"flex\"}}>\r\n                        <div className={styles.imageSide}>\r\n                            <h5>Cover Image</h5>\r\n                            {cover? <div className={styles.uploadImage}>\r\n                                        <img className={styles.coverPhoto} alt='' src={URL.createObjectURL(cover)}/>\r\n                                        <i className={`${styles.xIcon} fas fa-times fa-2x`} onClick={e=>{setCover(null)}}/>\r\n                                    </div> : \r\n                                    <div className={styles.uploadImage}>\r\n                                        <label htmlFor='fileInput' className={styles.icon}>\r\n                                            <i  className=\"fas fa-camera-retro\"></i>\r\n                                        </label>\r\n                                        <label htmlFor='fileInput' className={styles.uploadBtn}>Upload Image</label>\r\n                                        <input type='file' id='fileInput' required style={{display:'none'}} onChange={e=>{setCover(e.target.files[0])}}/>\r\n                                    </div>\r\n                                    }\r\n                            \r\n                            <div className={styles.notice}>\r\n                                For better design, please use:\r\n                                <ul>\r\n                                    <li>Minimum width image size is 1080</li>\r\n                                    <li>The best ratio is 16:9</li>\r\n                                </ul>\r\n                            </div>\r\n                        </div>\r\n                        <div className={styles.textSide}>\r\n                            <form className={styles.textForm} onSubmit={handleSubmit}>\r\n                                <div className={styles.textField}>\r\n                                    <label>Title of the Post<span className={styles.textDanger}>*</span></label>\r\n                                    <input name='title' type='text' required maxLength='500' className={styles.textInput} autoFocus={true} placeholder='Title' onChange={e=>{setTitle(e.target.value)}}/>\r\n                                </div>\r\n                                <div className={styles.textField}>\r\n                                    <label>Photographer's Name</label>\r\n                                    <input name='photographer' type='text' maxLength='500' className={styles.textInput} placeholder='Photographer Name...' onChange={e=>{setPhotographer(e.target.value)}}/>\r\n                                </div>\r\n                                <div className={styles.textField}>\r\n                                    <label>Sections<span className={styles.textDanger}>*</span></label>\r\n                                    <select name='sections' placeholder='Select section...' className={styles.textInput}  onChange={e=>{setSection(e.target.value)}}>\r\n                                        <option value='none' defaultValue className={styles.items}>Select section...</option>\r\n                                        <option value='photography' className={styles.items}>photography</option>\r\n                                        <option value='explore' className={styles.items}>explore</option>\r\n                                        <option value='photographers' className={styles.items}>photographers</option>\r\n                                        <option value='challenge' className={styles.items}>challenge</option>\r\n                                        <option value='book' className={styles.items}>book</option>\r\n                                        <option value='music' className={styles.items}>music</option>\r\n                                        <option value='life' className={styles.items}>life</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div className={styles.textField}>\r\n                                    <label>Categories<span className={styles.textDanger}>*</span></label>\r\n                                    <input name='categories' type='text' className={styles.textInput}  onChange={e=>{setCats(e.target.value.split(' '))}}/>\r\n                                </div>\r\n                                <div className={styles.textField}>\r\n                                    <label>Description<span className={styles.textDanger}>*</span></label>\r\n                                    <textarea name='description' type='text' className={styles.textInput} placeholder='Description'  onChange={e=>{setDesc(e.target.value)}}></textarea>\r\n                                </div>\r\n                                <div className={styles.textField}>\r\n                                    <label>Main Content<span className={styles.textDanger}>*</span></label>\r\n                                    {/* <ReactQuill theme='snow' value={content} onChange={setContent} placeholder='Show me something...' modules={modules} formats={formats} /> */}\r\n                                    <CKEditor\r\n                                        editor={ Editor }\r\n                                        config={ editorConfiguration }\r\n                                        // data='null'\r\n                                        // onReady={ editor => {\r\n                                        //     // You can store the \"editor\" and use when it is needed.\r\n                                        //     console.log( 'Editor is ready to use!', editor );\r\n                                        // } }\r\n                                        onChange={ ( event, editor ) => {\r\n                                            const data = editor.getData();\r\n                                            // console.log( { event, editor, data } );\r\n                                            setContent(data)\r\n                                            console.log(content)\r\n                                        } }\r\n                                        // onBlur={ ( event, editor ) => {\r\n                                        //     console.log( 'Blur.', editor );\r\n                                        // } }\r\n                                        // onFocus={ ( event, editor ) => {\r\n                                        //     console.log( 'Focus.', editor );\r\n                                        // } }\r\n                                    />\r\n                                </div>\r\n                                <div className={styles.submit}>\r\n                                    <button className={styles.uploadBtn}>Preview</button>\r\n                                    <button className={styles.uploadBtn} type='submit'>Submit</button>\r\n                                </div>\r\n                                {error ? <div><h5 style={{color:'red',textAlign:'right'}}>Something went wrong! Please check again...</h5></div>:null}\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}